
## Trusted Advisor中查看 AWS 资源

=== Trusted Advisor

> - **Trusted Advisor 凝聚**了从为**数十万 AWS 客户**提供服务中总结的**最佳实践**
> - Amazon Trusted Advisor 提供了以下**四种类别的最佳实践**：
> * **成本优化、安全、容错能力和性能提升**。
> - 您可以**使用 Trusted Advisor 检查**，**监视和改进** **EC2、ELB、EBS、S3、Auto Scaling、Amazon Identity and Access Management 和其他服务的部署**。
> - 您可以**在 Trusted Advisor 控制面板**上**查看亚马逊云科技资源和节省预估情况的整体状态**。

=== 架构图

image::/图片2/128图片/架构图.png[架构图]

== 实验步骤

=== 检查 Trusted Advisor 的控制面板

> - 请确保您位于**美国东部（弗吉尼亚北部）**us-east-1 区域。
> - 顶部菜单**导航到 Trusted Advisor**
> - **在 Trusted Advisor 的控制面板上**。您可以在此处**查看优化服务和资源的建议**。

image::/图片2/128图片/控制面板.png[控制面板]

> - **默认情况**下，当您**打开页面时**，**所有建议操作**都将**自动刷新以获取最新结果**。
> - 让我们**创建 2 个不受限制的安全组**和 **2 个公开 S3 存储桶**，以**了解有关Trusted Advisor的更多信息**。

---

=== 创建第一个不受限制的安全组

> - 请确保您位于**美国东部（弗吉尼亚北部）**us-east-1 区域
> - 顶部菜单**导航到 EC2**
> - 左侧面板，单击**"网络和安全"**，然后单击**"创建安全组"**。
> - 安全组名称：输入**``Security Group 1``**
> - 描述：**``First Security group``**
> - VPC：选择**``默认VPC``**
> - 在**"入站规则"**下，单击**"添加规则"**。
> - 添加 **SSH**

----
  . 选择类型： 选择 SSH
  . 协议：TCP
  . 端口范围：22
  . 源：选择"任何位置"
----

> - 将其他内容**保留为默认值**，然后单击**创建安全组按钮**。
> - 现**已创建安全组1**。

---

=== 创建第二个不受限制的安全组

> - 现在再次单击**"创建安全组"**。
> - 安全组名称：输入**``Security Group 2``**
> - 描述：**``Second Security group``**
> - VPC：选择**``默认VPC``**
> - 在**"入站规则"**下，单击**"添加规则"**。
> - 添加 **SSH**

----
  . 选择类型： 选择 SSH
  . 协议：TCP
  . 端口范围：22
  . 源：选择"任何位置"
----

> - 将其他内容**保留为默认值**，然后单击**创建安全组按钮**。
> - 现**已创建安全组2**。

---

=== 创建 2 个公开 S3 存储桶

> - 菜单**导航到S3**，**创建S3存储桶**
> - 请确保您位于**美国东部（弗吉尼亚北部）**us-east-1 区域。
> - 顶部菜单**导航到 S3**

image::/图片/09图片/导航到S3.png[导航到S3]

> - 在 S3 页面上，单击**``创建存储桶``**并**填写存储桶详细信息**。
> - 桶名称：输入**``demoawsfirst1``**
> * 注意： S3 存储桶名称是**全局唯一**的，请**选择一个可用的名称**。
> - AWS 区域：选择**美国东部（弗吉尼亚北部）美国东部-1**
> - 对于对象所有权：选择**``ACL 已启用``**
> * 对象所有权：选择**``对象编写者``**
> - 对于此存储桶的**“阻止公有访问”**设置部分
> * **取消选中**"阻止所有公共访问"选项，然后**选中确认**选项。
> - 将**其他设置保留**为默认值。
> - **创建存储桶按钮**
> - S3 **存储桶已创建**。
> - 单击**``权限``**选项卡，然后**配置以下内容**
> * 向下滚动到**存储桶策略**，单击右侧的**编辑**按钮。
> * 此时将显示一个空白的**存储桶策略编辑器**。
> * 将存储桶的 ARN 复制到**剪贴板**。
> * 例如**``arn:aws:s3:::demoawsfirst1``**
> - 复制下方**整个策略**，将其粘贴到存储桶策略中，
> - 下面 JSON 中的 ``Resource`` **改为自己的存储桶ARN**

```json
{
    "Version": "2012-10-17",
    "Id": "MYBUCKETPOLICY",
    "Statement": [
        {
            "Effect": "Allow",
            "Principal": "*",
            "Action": "s3:GetObject",
            "Resource": "arn:aws:s3:::demoawsfirst1/*"
        },
        {
            "Effect": "Allow",
            "Principal": {
                "AWS": "*"
            },
            "Action": "s3:PutObject",
            "Resource": "arn:aws:s3:::demoawsfirst1/*"
        },
        {
            "Effect": "Allow",
            "Principal": {
                "AWS": "*"
            },
            "Action": "s3:DeleteBucket",
            "Resource": "arn:aws:s3:::demoawsfirst1"
        }
    ]
}
```

> - 点击**``保存更改``**按钮。
> - 现在已**通过修改存储桶策略**的方式使S3存储桶**公开**
> - 按照**上述步骤（包括代码）操作**创建**另一个 S3 存储桶**，并将存储桶命名为 **``demoawssecond2``**
> - 别忘了**把它公开**。
> - 现在**已创建两个公开存储桶**。

---

=== 刷新“Trusted Advisor”

> - 请确保您位于**美国东部（弗吉尼亚北部）**us-east-1 区域。
> - 顶部菜单**导航到 Trusted Advisor**控制面板
> - **``Trusted Advisor``**有两种类型的**“刷新”**：**“刷新所有检查”**和**“仅刷新特定检查”**。
> - 对于**本实验**，我们将**执行全部刷新**，只需单击**``刷新所有检查``**按钮即可**完成操作**。
> - 刷新**最多需要 2 分钟**，之后将**显示所有已标记和不安全的资源**。

image::/图片2/128图片/不安全的资源.png[不安全的资源]

> - （可选）您可以单击**``下载所有检查``**按钮以**在excel文件中查看检查报告**。

---
