
## AWS GuardDuty 简介

=== AWS GuardDuty

> - AWS GuardDuty是一项**连续安全监视服务**，可以**分析和处理以下内容**。
> - **数据源**：**VPC 流日志，AWS CloudTrail管理事件日志，CloudTrailS3 数据事件日志、EKS 审核日志和 DNS 日志**。
> - 它使用**威胁情报源** (例如，恶意 IP 地址和域的列表) 和**机器学习**来**标识您意外的和未经授权的恶意活动**。
> - 这包括了**特权升级**、使用**遭暴露的凭证**或者与**恶意 IP 地址**或**域通信等问题**。
> - 例如，GuardDuty 可**检测恶意软件**或**进行比特币挖矿的受损 EC2 实例**。
> - 它还可以**监控AWS帐户访问行为是否有受损迹象**，如**未经授权的基础设施部署**（例如，在从未使用过的区域中部署的实例）或**异常的 API 调用**（例如，更改密码策略以减小密码强度）。

=== 架构图

image::/图片2/131图片/架构图.png[架构图]

== 实验步骤

=== 启用 Amazon GuardDuty

> - 请确保您位于**美国东部（弗吉尼亚北部）**us-east-1 区域
> - 顶部菜单**导航到 GuardDuty**
> - 单击**“开始使用”**按钮。
> - 单击**启用 GuardDuty**按钮。只需**单击一下**，该服务**将启用**。

image::/图片2/131图片/启用.png[启用]

> - 在**结果页面**中，您将看到提示您**没有任何结果**，因为**您的 AWS 账户中没有发生恶意活动**。

---

=== 探索 Amazon GuardDuty

==== 设置

> - 单击**左侧面板**中的**“设置”**。
> - 您将看到一个**探测器 ID**。探测器是**表示 GuardDuty 服务的资源**。
> - 权限：GuardDuty 代表您**使用服务角色**来**监视您的数据源**。
> - 结果导出选项：结果将**自动发送到 CloudWatch 事件**。您还可以将**结果导出到 S3 存储桶**。新结果**将在 5 分钟内导出**。**无需更改任何内容**。
> - 暂停 GuardDuty：
> * 暂停 GuardDuty：当您**暂停 GuardDuty 时**，它会**停止监控您的 AWS 环境**，并且**不会生成新的结果**。您现有的**结果保持不变**，**不受影响**。
> * 禁用 GuardDuty：**禁用 GuardDuty 时**，您不仅会**阻止 GuardDuty 监控您的 AWS 环境**并**生成新的结果**，还会**丢失现有的结果**和 **GuardDuty 配置**。您以后**无法恢复**数据。

==== 清单

> - 单击**“设置”**下方的**“清单”**。
> - 在**列表管理**中，可以添加**“可信 IP 列表”**和**“威胁列表”**。
> - 可信 IP 列表：**可信 IP 列表**包含**已列入受信任的**、**可与您的 AWS 环境安全通信的 IP 地址**。GuardDuty **不会为可信 IP 列表**中包含的 IP 地址**生成结果**。
> - 威胁列表：威胁列表**包含已知的恶意 IP 地址**。GuardDuty 将**为威胁列表中包含的 IP 地址生成结果**。

image::/图片2/131图片/列表.png[列表]


==== 帐户

> - 单击**“设置”**下方的**“帐户”**。
> - 您可以**邀请其他账户启用 GuardDuty 并与您的 AWS 账户关联**。
> - 接受邀请后，您的帐户将被**指定为 GuardDuty 主帐户**。
> - **接受邀请的账户**将**成为与您的主账户关联的成员账户**。
> - 然后，您可以代表**成员账户查看和管理 GuardDuty 结果**。在 GuardDuty 中，**一个主账户（每个区域）最多可以有 1000 个成员账户**。

==== 生成示例结果

> - 由于**我们的 AWS 账户中没有潜在威胁**，因此让我们**生成一些示例结果并了解它们**。
> - **导航到设置**，向下滚动并单击**生成示例结果**按钮。
> - 若要**查找示例结果**，请转到**“结果”**。
> - **等到加载完成**。在右上角，您应该**看到许多结果**。

image::/图片2/131图片/发现.png[发现]

> - 在右上角，您可以看到**带有颜色的数字**。
> - **颜色表示**：
> * 蓝色表示**低严重性**
> * 橙色表示**中等严重性**
> * 红色表示**严重性高**
> - 您还可以使用**筛选条件来筛选结果**。

image::/图片2/131图片/筛选结果.png[筛选结果]

> - 单击**其中一个示例结果**。
> - 您可以看到**各种参数**，如**严重级别，区域，帐户ID，资源ID，受影响的资源**等。

image::/图片2/131图片/目标等.png[目标等]

> - **浏览更多示例结果**以**了解有关不同严重性的详细信息**。

---
