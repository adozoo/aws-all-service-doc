
## 数据库添加到Elastic Beanstalk

=== 架构图

image::/图片/69图片/架构图.png[架构图]

== 实验步骤

=== 创建 Elastic Beanstalk 应用程序

> - 确保您位于**美国东部（弗吉尼亚北部）**us-east-1 区域。
> - 通过单击顶部的服务菜单导航到 **Elastic Beanstalk**
> - 在 Elastic Beanstalk 中，您将看到一个``欢迎界面``。您需要做的就是单击**``创建应用程序``**按钮。
> - 在此页面上，我们将输入简单的详细信息以使应用程序启动并运行：
> * 应用程序名称：输入**``SampleApplication``**
> * 将应用程序标签保留为**默认值**。
> * 在"平台"下：选择**"Java"**
> * 将其他设置**保留为默认值**。
> * 单击**创建应用程序**按钮。AWS 将开始工作为您**创建环境**。
> * 注意：此过程通常需要**大约 10 到 15 分钟才能完成**。
> - 完成上述操作后，您将能够在仪表板中看到**``SampleApplictaion``**。这是您的Elastic Beanstalk应用程序的**主界面**。下面给出了示例**屏幕截图**：

image::/图片/67图片/创建完成.png[创建完成]

> - 在仪表板上，可以看到**应用程序 URL**。
> * ``Sampleapplication-env.eba-bw6ymmmp.us-east-1.elasticbeanstalk.com``
> - 若要**测试应用程序**，请**复制应用 URL **并**粘贴到浏览器**中。您将看到应用程序**正在成功运行**。下面给出了示例**屏幕截图**：

image::/图片/67图片/应用程序.png[应用程序]

> - 您还可以在左侧配置菜单中更改应用程序的其他**重要配置选项**，如**数据库**、**软件**和**实例**。

---

=== 将数据库添加到Elastic Beanstalk环境

> - 单击左侧面板中的**配置**。
> - 在配置页面中**向下滚动**以**查找数据库**。单击**编辑**。

image::/图片/69图片/编辑数据库.png[编辑数据库]

> - 在**"数据库设置"**下
> * 引擎 ： 选择 **``mysql``**
> * 引擎版本：选择任何**最新的版本**
> * 实例类：选择 **``db.t2.micro``**
> * 存储空间 ： **``5 GB``**
> * 用户名 ： 输入 **``awslabsAdmin``**
> * 密码 ： 输入 **``awslabs123``**
> * 数据库删除策略 ：选择**``删除``**
> * 适用性 ： 选择**``低（单可用区）``**
> * 单击**"应用"**。
> - 数据库创建现在将开始。创建 RDS 数据库需要**完成几个过程**。
> - 单击"刷新"按钮以**获取更新**。
> - 配置更新过程将**需要 15-20 分钟**。请等到该过程**完成**。
> - 完成后，您将能够看到**最终状态**：
> * **环境更新已成功完成**。
> - RDS 数据库已创建。您可以在**"最近事件"**中看到该消息。
> * **实例部署已成功完成**。

image::/图片/69图片/部署完成.png[部署完成]

> - **编辑 RDS 的安全组**
> * 要从 Elastic Beanstalk 环境中获取 RDS 安全组，请单击左侧面板中的**配置**。向下滚动以**查找数据库**。
> * 单击**"终端节点"**链接。将**打开一个新选项卡**。
> * 单击**数据库标识符名称**
> * 在右侧的**"安全性"**下的**"连接和安全性"**下，您将能够**看到 RDS 的 VPC 安全组**。

image::/图片/69图片/vpc安全组.png[vpc安全组]

> - 单击**安全组名称**。您将导航到**"安全组"**页面。
> - 选择入站规则，然后单击**编辑入站**规则
> - 将有一个条目存在，将其保留为**默认值**。
> - 单击**添加规则**按钮。
> - 添加 **RDS**：

----
  . 选择类型： 选择 MySQL/Aurora
  . 协议：TCP
  . 端口范围：3306
  . 源：选择"任何位置"
----

> - 点击**保存规则**按钮。

---

=== 测试 RDS 数据库连接

> - 使用 MySQL 图形化连接工具**连接到数据库实例上的数据库**，请**查找数据库实例的终端节点（DNS 名称）和端口号**。
> - 导航到并单击**"创建的RDS数据库实例"**。
> - 在**"连接和安全"**部分下，**复制并记下终端节点和端口**。
> * 终端节点：**复制终端节点**
> * 端口：**3306**
> * 您需要**终端节点**和**端口号**才能**连接到数据库实例**。
> - 打开 MySQL 图形化**连接工具**。单击**加号图标**

==== 本机情况

> - 连接名称：输入示例名称 **``Beanstalk Database``**
> - 主机名：**``已复制的终端节点``**
> - 端口： **``3306``**
> - 用户名： **``awslabsAdmin``**
> - 密码： **``awslabs123``**
> - 单击**"测试连接"**以**确保能够正确连接到数据库**。

image::/图片/47图片/测试成功.png[测试成功]

> - 单击**"保存"**以**保存连接**。
> - 成功连接并**打开数据库后**，**可以创建表并对连接的数据库执行各种查询**。

image::/图片/69图片/连接成功.png[连接成功]

---
