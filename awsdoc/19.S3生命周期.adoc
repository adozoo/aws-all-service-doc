
## S3生命周期


=== 什么是生命周期管理？

> - 使用生命周期管理，以便在对象的整个生命周期中**经济高效地存储对象**。
> - 生命周期配置是一组规则，**用于定义 S3 应用**于一组对象的操作。
> - 生命周期定义了**两种类型的操作**：
> * **转换操作**：当您定义到另一个存储类的**转换时**。例如，您选择在创建对象 30 天后将对象传输到标准 IA 存储类，或在创建对象 90 天后将对象归档到 Glacier 存储类。
> * **过期操作**：您需要定义对象**何时过期**，Amazon S3 会代表您**删除过期的对象**。
> - 生命周期政策：
> * 使用生命周期规则管理您的对象：您可以使用生命周期规则来**管理对象的生命周期**，该规则定义了 Amazon S3 在其生命周期内如何管理对象。
> * 自动过渡到分层存储：生命周期**允许**您将对象自动过渡到标准 IA 存储类，然后再过渡到 Glacier 存储类。
> * 使您的对象过期：使用生命周期规则，您可以**自动使您的对象过期**。

=== 架构图

image::/图片/19图片/架构图.png[架构图]


== 实验步骤

=== 创建 S3 存储桶

> - 请确保您位于**美国东部（弗吉尼亚北部）**us-east-1 区域。
> - 顶部菜单**导航到 S3**

image::/图片/09图片/导航到S3.png[导航到S3]

> - 在 S3 页面上，单击``创建存储桶``并**填写存储桶详细信息**。
> - 桶名称：输入``mys3bucket-test-abcd``
> * 注意： S3 存储桶名称是**全局唯一**的，请**选择一个可用的名称**。
> - AWS 区域：选择美国东部（弗吉尼亚北部）美国东部-1
> - 对于对象所有权：选择**ACL 已禁用(推荐)**
> - 将**其他设置保留**为默认值。
> - **创建存储桶按钮**
> - S3 **存储桶已创建**。


image::/图片/19图片/成功创建存储桶.png[成功创建存储桶]

=== 上传对象

> - 点击**对象**选项卡，您可以看到**以下消息**
> * 此存储桶中**没有任何对象**。

image::/图片/17图片/没有对象.png[没有对象]

> - 您可以从本地计算机**上传测试文件.txt**
> * 测试文件**内容**为

```txt
  This is version 1
```


> - 将文件**上传**到我们的 S3 存储桶
> * 点击**上传**按钮。
> * 点击**添加文件**按钮。
> * 浏览您的本地测试文件.txt**并选择它**
> * 单击上传按钮**上传**。
> - 您可以从屏幕顶部的传输面板中**查看上传进度**。
> - 上传文件后，它将**显示在存储桶中**。

image::/图片/18图片/上传图片成功.png[上传图片成功]


---

=== 创建生命周期规则

> - 单击"管理"选项卡。
> - 在**生命周期**规则下，单击``创建生命周期规则``，为上传的对象创建生命周期规则。
> - 生命周期规则名称：**输入 awstest**
> - 选择规则范围：选择应用到存储桶中的**所有对象**并**确认**


image::/图片/19图片/名称.png[名称]


> - 在"生命周期规则操作"下：选中以下**复选框**。


image::/图片/19图片/规则操作.png[规则操作]


> - 对于``在存储类之间转移对象的当前版本``部分
> * 选择**存储类转换**：选择单区 - IA
> * 创建对象以来的**天数**：输入 30
> * 点击``添加转换``按钮
> * 选择**存储类转换**：选择 Glacier Flexible Retrieval（以前称为 Glacier）
> * 创建对象以来的**天数**：输入 90
> * **确认**你想把他们转换到Glacier

image::/图片/19图片/单区IA.png[单区IA]

> - 对于``将对象的当前版本设为过期``部分
> * 创建对象以来的天数：**输入 120**
> - 注意：在此选项中，您指定 120 天后，**对象**将过期（自动删除）。


image::/图片/19图片/过期.png[过期]


> - 对于``删除过期的对象删除标记或未完成的分段上传``部分
> * **未完成的分段上传**，选中"删除未完成的分段上传"选项
> * **天数**： 输入 90


image::/图片/19图片/删除分段.png[删除分段]


> - 最后，检查**审查转换和过期操作**，然后单击**"创建规则"**按钮。

image::/图片/19图片/审查.png[审查]

> - 现在，生命周期规则**已创建**，并且处于**启用状态**。

image::/图片/19图片/成功.png[成功]


---
