
## Lambda 集成构建 API 网关

=== Amazon API Gateway

> - Amazon API Gateway 是一项**完全托管的服务**，使开发人员可以**轻松创建、发布、维护、监控和保护任何规模的 API**。
> - API 充当应用程序从**后端服务访问数据**、**业务逻辑**或**功能的前门**。
> - API 网关可处理**接受和处理**多达**数十万个并发 API 调用**所涉及的**所有任务**，包括**流量管理、CORS 支持、授权和访问控制、限制、监控和 API 版本管理**。
> - 使用 API 网关，您可以创建 **RESTful API 和 WebSocket API**，以支持实时**双向通信应用程序**。API 网关支持**容器化**和**无服务器**工作负载以及 Web 应用程序。
> - 借助 AWS Lambda，您可以在**不预置或管理服务器**的情况下**运行代码**。您只需为使用的**计算时间付费**。
> - 借助 Lambda，您几乎可以为**任何类型的应用程序或后端服务**运行代码 - 所有这些都**无需管理**。
> - 只需**上传您的代码**，Lambda 就会处理运行和扩展您的代码**所需的一切**，并具有**高可用性**。您可以将代码设置为从**其他 AWS 服务自动触发**，或**直接从任何 Web 或移动应用程序调用代码**。

=== 架构图

image::/图片/72图片/架构图.png[架构图]

== 实验步骤

=== 创建 Lambda 函数

> - 确保您位于**美国东部（弗吉尼亚北部）区域**。
> - 转到菜单，然后单击 **Lambda**。

image::/图片/09图片/导航到Lambda.png[导航到Lambda]

> - 单击**创建函数**该按钮。
> - 选择**``从头开始创建``**
> - 函数名称：输入 **``awslabsAPI``**
> - 运行时：**``Python 3.9``**
> - 角色：在权限部分中，单击**"更改默认执行角色"**，然后单击**"从 AWS 策略模板创建新角色"**。
> - 输入角色名称为**``awslabsAPI``**，选择策略模板为**``基本 Lambda@Edge 权限（适用于 CloudFront 触发器）``**
> * 点击**创建函数**该按钮。
> - **成功创建 Lambda 函数后**，它将类似于下面的**屏幕截图**：

image::/图片/72图片/lambda.png[lambda]

---

=== 创建 API

> - 请确保您位于**美国东部（弗吉尼亚北部）**us-east-1 区域
> - 顶部菜单**导航到 ``API Gateway``**
> - 向下滚动找到**REST API**并单击**"构建"**按钮。

image::/图片/70图片/1.png[1]

> - 忽略弹出窗口**"创建您的第一个 API"**，然后选择**协议为 REST**。
> - 然后选择"设置"下的**"新建 API "**。输入 API 名称为**``awslab API``**，然后单击**"创建 API"**
> - 单击左侧面板中的**API**，**查看您创建的 awslab API**

image::/图片/70图片/2.png[2]

> - 注意： 如果出现任何弹出窗口，请**忽略它们**。

---

=== 创建资源

> - 创建 API 后，单击**``awslab API``**，然后单击**操作**按钮
> - 在操作中选择**创建资源**选项。
> * 资源名：输入**``awslabs``**
> - 输入资源名称后，单击**"创建资源"**按钮

---

=== 创建方法

> - 创建资源后，单击**"操作"**，然后选择**创建方法**。从下拉列表中选择**``GET``**，然后单击**``√``**。
> - 选择集成类型为**Lambda 函数**
> - 输入以下**详细信息**：
> * Lambda 区域：**``us-east-1``**
> * Lambda 函数：**``awslabsAPI``**
> * 将**其他选项保留为默认值**，然后单击**保存**。

image::/图片/72图片/方法.png[方法]

> - 创建后，您将**看到此页面**。

image::/图片/72图片/创建完成.png[创建完成]


---

=== 部署 API

> - 成功**创建资源和方法**后，即可**部署 API**。
> - 单击操作选择**部署API**。
> - 将下拉列表中的**"部署阶段"**选择为**"新阶段"**。
> - 输入阶段名称 ： **``TestingAPI``**
> - 输入描述 ： **``Testing environment for my awslabsAPI``**
> - 单击**部署**。
> - 部署 API 后，导航到**"阶段"**，然后单击**"TestingAPI"**。
> - 您将能够**看到以下内容**：

image::/图片/72图片/部署完成.png[部署完成]

> - 单击**调用 URL链接**以**发出GET请求**。
> - 现在，在**调用URL的末尾** **添加``/awslabs``**，然后按**键盘上的[Enter]键**。
> - 您将收到**来自 API 的 GET 响应**。下面是一个**示例截图**：

image::/图片/72图片/get响应.png[get响应]

---
