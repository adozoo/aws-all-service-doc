

## Cloudshell生成S3预签名


=== 什么是 AWS Cloud Shell？

> - AWS CloudShell 是一个基于**浏览器的 shell**，可让您轻松**管理、探索 AWS 资源**并**安全地与之交互**。
> - 借助 CloudShell，您可以使用 AWS 命令行界面 （AWS CLI） **快速运行脚本**，使用 AWS 开发工具包试验 **AWS 服务 API**，或使用一系列其他工具


=== 优势：

> - CloudShell 继承登录到 AWS 管理控制台的**用户凭证**。
> - 完全托管的 Amazon Linux 2 环境，已安装并更新了**最新版本的常用工具**。
> - 每个区域具有 **1 GB 的持久性存储**，您可以将**脚本、文件、配置**首选项等**存储在主目录中**。

=== 架构图

image::/图片/24图片/s3_presign.png[s3_presign]


== 实验步骤

=== 创建 S3 存储桶


> - 请确保您位于**美国东部（弗吉尼亚北部）**us-east-1 区域。
> - 顶部菜单**导航到 S3**

image::/图片/09图片/导航到S3.png[导航到S3]

> - 在 S3 页面上，单击``创建存储桶``并**填写存储桶详细信息**。
> - 桶名称：输入``mys3bucket-test-abcd``
> * 注意： S3 存储桶名称是**全局唯一**的，请**选择一个可用的名称**。
> - AWS 区域：选择美国东部（弗吉尼亚北部）美国东部-1
> - 对于对象所有权：选择**ACL 已禁用(推荐)**
> - 将**其他设置保留**为默认值。
> - **创建存储桶按钮**
> - S3 **存储桶已创建**。


image::/图片/19图片/成功创建存储桶.png[成功创建存储桶]

=== 将对象上传到 S3 存储桶


> - **单击**您的存储桶名称。
> - 在对象中，您可以看到**以下消息**
> * 此存储桶中**没有任何对象**。

image::/图片/17图片/没有对象.png[没有对象]


> - 您可以从本地计算机**上传任何图像**
> - 将文件上传到我们的 S3 存储桶
> * 点击**上传**按钮。
> * 点击**添加文件**按钮。
> * 浏览您的本地图像**并选择它**
> * 单击上传按钮**上传**。
> - 您可以从屏幕顶部的传输面板中**查看上传进度**。
> - 上传文件后，它将**显示在存储桶中**。

image::/图片/17图片/上传图片成功.png[上传图片成功]


> - 单击``复制 S3 URI``按钮。
> - 注意：将复制的 S3 URI **保留在记事本中**，在**后续步骤中将需要用到它**。


=== 在 CloudShell 中创建环境

> - 单击右上角 AWS 菜单栏上的**（Cloud Shell）图标**。

image::/图片/24图片/控制台.png[控制台]

> - 浏览器中将打开一个新选项卡，如果您看到一条**指向 cloud shell 的欢迎消息**，请单击该消息中的"关闭"按钮。
> - 您将在屏幕上看到一条**正在创建环境的消息**。

image::/图片/24图片/正在创建环境.png[正在创建环境]

> - 等待几分钟以**完成环境创建**。创建环境后，您就可以**使用终端了**。


image::/图片/24图片/环境创建完成.png[环境创建完成]


=== 运行 S3 预签名命令并测试输出

> - **运行以下命令**，创建 s3 预签名 URL。
> - 语法：aws s3 presign [S3 URI] --expires-in 60
> - 示例：aws s3 presign s3://mys3bucket-test-abcd/95159676_p0.png --expires-in 60
> - Enter查看**输出**，**复制完整的URL**。

image::/图片/24图片/授权.png[授权]


> - 然后，**粘贴到浏览器中访问**。

image::/图片/24图片/可以访问.png[可以访问]



> - 1分钟后刷新页面，**页面消失**，因为它仅在**60秒内有效**，即1分钟。

image::/图片/24图片/xml.png[xml]


---
